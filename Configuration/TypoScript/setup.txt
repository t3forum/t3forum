plugin.tx_srfeuserregister_pi1 {
    create {
        overrideValues.tx_extbase_type = T3forum\T3forum\Domain\Model\User\FrontendUser
        fields := addToList(tx_extbase_type)
    }
}

config.tx_extbase.objects {
    T3forum\T3forum\Service\Mailing\MailingServiceInterface.className = T3forum\T3forum\Service\Mailing\PlainMailingService
}

config.tx_extbase.persistence.classes {
    TYPO3\CMS\Extbase\Domain\Model\FrontendUser.subclasses {
        T3forum\T3forum\Domain\Model\User\FrontendUser = T3forum\T3forum\Domain\Model\User\FrontendUser
    }

    TYPO3\CMS\Extbase\Domain\Model\FrontendUserGroup.subclasses {
        T3forum\T3forum\Domain\Model\User\FrontendUserGroup = T3forum\T3forum\Domain\Model\User\FrontendUserGroup
    }

    T3forum\T3forum\Domain\Model\User\FrontendUser {
        mapping {
            tableName = fe_users
            recordType = T3forum\T3forum\Domain\Model\User\FrontendUser

            columns {
                tx_t3forum_signature.mapOnProperty = signature
                tx_t3forum_post_count.mapOnProperty = postCount
                tx_t3forum_post_count_session.mapOnProperty = postCountSession
                tx_t3forum_topic_count.mapOnProperty = topicCount
                tx_t3forum_helpful_count.mapOnProperty = helpfulCount
                tx_t3forum_helpful_count_session.mapOnProperty = helpfulCountSession
                tx_t3forum_question_count.mapOnProperty = questionCount
                tx_t3forum_support_posts.mapOnProperty = supportPosts
                tx_t3forum_facebook.mapOnProperty = facebook
                tx_t3forum_twitter.mapOnProperty = twitter
                tx_t3forum_google.mapOnProperty = google
                tx_t3forum_skype.mapOnProperty = skype
                tx_t3forum_job.mapOnProperty = job
                tx_t3forum_interests.mapOnProperty = interests
                tx_t3forum_working_environment.mapOnProperty = workingEnvironment
                tx_t3forum_topic_favsubscriptions.mapOnProperty = topicFavSubscriptions
                tx_t3forum_topic_subscriptions.mapOnProperty = topicSubscriptions
                tx_t3forum_forum_subscriptions.mapOnProperty = forumSubscriptions
                tx_t3forum_read_topics.mapOnProperty = readTopics
                tx_t3forum_read_forum.mapOnProperty = readForum
                tx_t3forum_use_gravatar.mapOnProperty = useGravatar
                tx_t3forum_contact.mapOnProperty = contact
                tx_t3forum_private_messages.mapOnProperty = privateMessages
                tx_t3forum_rank.mapOnProperty = rank
                tx_t3forum_points.mapOnProperty = points
                date_of_birth.mapOnProperty = dateOfBirth
            }
        }
    }

    T3forum\T3forum\Domain\Model\User\FrontendUserGroup {
        mapping {
            tableName = fe_groups
            recordType = T3forum\T3forum\Domain\Model\User\FrontendUserGroup
            columns {
                tx_t3forum_user_mod.mapOnProperty = userMod
            }
        }
    }

    T3forum\T3forum\Domain\Model\User\Userfield\AbstractUserfield {
        mapping {
            tableName = tx_t3forum_domain_model_user_userfield_userfield
            recordType = T3forum\T3forum\Domain\Model\User\Userfield\AbstractUserfield
        }

        subclasses {
            T3forum\T3forum\Domain\Model\User\Userfield\TyposcriptUserfield = T3forum\T3forum\Domain\Model\User\Userfield\TyposcriptUserfield
            T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield = T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield
        }
    }

    T3forum\T3forum\Domain\Model\User\Userfield\TyposcriptUserfield {
        mapping {
            tableName = tx_t3forum_domain_model_user_userfield_userfield
            recordType = T3forum\T3forum\Domain\Model\User\Userfield\TyposcriptUserfield
        }

        subclasses {
            T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield = T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield
        }
    }

    T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield {
        mapping {
            tableName = tx_t3forum_domain_model_user_userfield_userfield
            recordType = T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield
        }
    }

    T3forum\T3forum\Domain\Model\Moderation\AbstractReport {
        mapping {
            tableName = tx_t3forum_domain_model_moderation_report
        }

        subclasses {
            T3forum\T3forum\Domain\Model\Moderation\UserReport = T3forum\T3forum\Domain\Model\Moderation\UserReport
            T3forum\T3forum\Domain\Model\Moderation\PostReport = T3forum\T3forum\Domain\Model\Moderation\PostReport
        }
    }

    T3forum\T3forum\Domain\Model\Moderation\UserReport {
        mapping {
            tableName = tx_t3forum_domain_model_moderation_report
            recordType = T3forum\T3forum\Domain\Model\Moderation\UserReport
        }
    }

    T3forum\T3forum\Domain\Model\Moderation\PostReport {
        mapping {
            tableName = tx_t3forum_domain_model_moderation_report
            recordType = T3forum\T3forum\Domain\Model\Moderation\PostReport
        }
    }

    T3forum\T3forum\Domain\Model\Format\AbstractTextParserElement {
        mapping {
            tableName = tx_t3forum_domain_model_format_textparser
        }

        subclasses {
            T3forum\T3forum\Domain\Model\Format\BBCode = T3forum\T3forum\Domain\Model\Format\BBCode
            T3forum\T3forum\Domain\Model\Format\Smiley = T3forum\T3forum\Domain\Model\Format\Smiley
            T3forum\T3forum\Domain\Model\Format\SyntaxHighlighting = T3forum\T3forum\Domain\Model\Format\SyntaxHighlighting
        }
    }

    T3forum\T3forum\Domain\Model\Format\BBCode {
        mapping {
            tableName = tx_t3forum_domain_model_format_textparser
            recordType = T3forum\T3forum\Domain\Model\Format\BBCode
        }

        subclasses {
            T3forum\T3forum\Domain\Model\Format\QuoteBBCode = T3forum\T3forum\Domain\Model\Format\QuoteBBCode
            T3forum\T3forum\Domain\Model\Format\ListBBCode = T3forum\T3forum\Domain\Model\Format\ListBBCode
        }
    }

    T3forum\T3forum\Domain\Model\Format\QuoteBBCode {
        mapping {
            tableName = tx_t3forum_domain_model_format_textparser
            recordType = T3forum\T3forum\Domain\Model\Format\QuoteBBCode
        }
    }

    T3forum\T3forum\Domain\Model\Format\ListBBCode {
        mapping {
            tableName = tx_t3forum_domain_model_format_textparser
            recordType = T3forum\T3forum\Domain\Model\Format\ListBBCode
        }
    }

    T3forum\T3forum\Domain\Model\Format\Smiley {
        mapping {
            tableName = tx_t3forum_domain_model_format_textparser
            recordType = T3forum\T3forum\Domain\Model\Format\Smiley
        }
    }

    T3forum\T3forum\Domain\Model\Format\SyntaxHighlighting {
        mapping {
            tableName = tx_t3forum_domain_model_format_textparser
            recordType = T3forum\T3forum\Domain\Model\Format\SyntaxHighlighting
        }
    }

    T3forum\T3forum\Domain\Model\Forum\Topic {
        mapping {
            tableName = tx_t3forum_domain_model_forum_topic
            recordType = 0
        }

        subclasses {
            T3forum\T3forum\Domain\Model\Forum\ShadowTopic = T3forum\T3forum\Domain\Model\Forum\ShadowTopic
        }
    }

    T3forum\T3forum\Domain\Model\Forum\ShadowTopic {
        mapping {
            tableName = tx_t3forum_domain_model_forum_topic
            recordType = 1
        }
    }

    T3forum\T3forum\Domain\Model\Forum\CriteriaOption {
        mapping {
            tableName = tx_t3forum_domain_model_forum_criteria_options
            recordType = 1
        }
    }

    T3forum\T3forum\Domain\Model\User\PrivateMessageText {
        mapping {
            tableName = tx_t3forum_domain_model_user_privatemessage_text
            recordType = 1
        }
    }
}

plugin.tx_t3forum.settings {
    debug = {$plugin.tx_t3forum.settings.debug}
    debug {
        disableACLs = 0
    }

    cutUsernameOnChar = {$plugin.tx_t3forum.settings.cutUsernameOnChar}
    cutBreadcrumbOnChar = {$plugin.tx_t3forum.settings.cutBreadcrumbOnChar}
    useSqlStatementsOnCriticalFunctions = {$plugin.tx_t3forum.settings.useSqlStatementsOnCriticalFunctions}

    images {
        avatar.uploadDir = uploads/pics
        # use following definitions to have different Default avatars for male and female
        #avatar.dummyMale = /uploads/path_to_male_avatar.jpg
        #avatar.dummyFemale = /uploads/path_to_female_avatar.jpg
    }

    pids {
        Forum = {$plugin.tx_t3forum.settings.pids.Forum}
        UserShow = {$plugin.tx_t3forum.settings.pids.UserShow}
        UserList = {$plugin.tx_t3forum.settings.pids.UserList}
        UserEdit = {$plugin.tx_t3forum.settings.pids.UserEdit}
        Dashboard = {$plugin.tx_t3forum.settings.pids.Dashboard}
        AllQuestions = {$plugin.tx_t3forum.settings.pids.AllQuestions}
    }

    user {
        iconClass_online = iconset-14-user-online
        iconClass_offline = iconset-14-user-offline
    }

    attachment {
        allowedMimeTypes = image/gif,image/jpeg,image/png,application/pdf,application/xml,text/plain
        allowedSizeInByte = 4096
        #uploadfolder can be found in the Attachment TCA
    }

    forum {
        post {
            helpfulBtn {
                iconClass = iconset-22-helpful
                eID = t3forum
            }
        }
    }

    ads {
        timeInterval = 30
    }

    topicIcon {
        basepath =
    }

    forumIcon {
        basepath =
    }

    pagebrowser {
        default {
            itemsPerPage = 20
            showResultCount = 1
            insertBelow = 1
            maximumNumberOfLinks = 9
            showFirstLast = 1
            browseBoxWrap = <div class="tx-ttnews-browsebox"><p>|</ul></div>
            showResultsWrap = |</p><ul>
            LinksWrap = |
            browseLinksWrap = |
            activeLinkWrap = <li><strong>|</strong></li>
            disabledLinkWrap = <li>|</li>
            inactiveLinkWrap = <li>|</li>
        }

        topicShow < .default
        topicShow {
            insertAbove = 1
            itemsPerPage = 10
        }
    }

    forumController.show {
        pagebrowser < plugin.tx_t3forum.settings.pagebrowser.default
    }

    topicController.show {
        pagebrowser < plugin.tx_t3forum.settings.pagebrowser.default
        pagebrowser {
            itemsPerPage = 10
        }
    }

    userController.index {
        pagebrowser < plugin.tx_t3forum.settings.pagebrowser.default
    }

    userController.listPosts {
        pagebrowser < plugin.tx_t3forum.settings.pagebrowser.default
    }

    format {
        dateFormat = d. m. Y
        dateTimeFormat = d. m. Y, H:i
    }

    widgets {
        newestPosts.limit = 6
        questionPosts.limit = 6
        popularPosts.limit = 6
        helpfulUser.limit = 4
        activeUser.limit = 4
        onlinebox {
            limit = 6
            timeInterval = 900
        }
    }

    mailing {
        sender {
            address = mail@mail.de
            name = Absender
        }
    }

    textParsing {
        enabledServices {
            basic = T3forum\T3forum\TextParser\Service\BasicParserService
            bbCodes = T3forum\T3forum\TextParser\Service\BBCodeParserService
            smileys = T3forum\T3forum\TextParser\Service\SmileyParserService
            #syntax = T3forum\T3forum\TextParser\Service\SyntaxHighlightingParserService
            quotes = T3forum\T3forum\TextParser\Service\QuoteParserService
            quotes {
                template = {$plugin.tx_t3forum.view.partialRootPath}/Format/Quote.html
            }

            lists = T3forum\T3forum\TextParser\Service\ListParserService
        }

        editorPanel {
            panels {
                bbCodes {
                    className = T3forum\T3forum\TextParser\Panel\BbCodePanel
                    title = LLL:EXT:t3forum/Resources/Private/Language/locallang.xml:Editor_Panel_Formatting
                }

                syntax {
                    className = T3forum\T3forum\TextParser\Panel\SyntaxHighlightingPanel
                    title = LLL:EXT:t3forum/Resources/Private/Language/locallang.xml:Editor_Panel_SyntaxHighlighting
                    iconClassName = tx-t3forum-miu-code
                }

                smileys {
                    className = T3forum\T3forum\TextParser\Panel\SmileyPanel
                    title = LLL:EXT:t3forum/Resources/Private/Language/locallang.xml:Editor_Panel_Smileys
                    iconClassName = tx-t3forum-miu-smileys
                }
            }
        }
    }

    userfields.core_fields {
        username {
            class = T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield
            properties {
                name = LLL:EXT:t3forum/Resources/Private/Language/locallang_user.xml:Username
                mapToUserObject = username
            }
        }

        registered_since {
            class = T3forum\T3forum\Domain\Model\User\Userfield\DateUserfield
            properties {
                name = LLL:EXT:t3forum/Resources/Private/Language/locallang_user.xml:RegisteredSince
                mapToUserObject = crdate
            }
        }

        real_name {
            class = T3forum\T3forum\Domain\Model\User\Userfield\TextUserfield
            properties {
                name = LLL:EXT:t3forum/Resources/Private/Language/locallang_user.xml:RealName
                mapToUserObject = name
            }
        }
    }
}

plugin.tx_t3forum.view {
    widget.TYPO3\CMS\Fluid\ViewHelpers\Widget\PaginateViewHelper.templateRootPath = {$plugin.tx_t3forum.view.templateRootPath}

    templateRootPaths {
        0 = {$plugin.tx_t3forum.view.templateRootPath}
        10 = {$plugin.tx_t3forum.view.templateRootPath.10}
    }

    partialRootPaths {
        0 = {$plugin.tx_t3forum.view.partialRootPath}
        10 = {$plugin.tx_t3forum.view.partialRootPath.10}
    }

    layoutRootPaths {
        0 = {$plugin.tx_t3forum.view.layoutRootPath}
        10 = {$plugin.tx_t3forum.view.layoutRootPath.10}
    }
}

plugin.tx_t3forum.renderer.navigation {
    userlink = COA
    userlink {
        stdWrap.wrap = <li class="dropdown"> | </li>

        10 = CASE
        10 {
            key.field = uid
            0 = TEXT
            0.field = username
            0.noTrimWrap = |<a style="padding-top: 4px; padding-bottom: 4px;" href="#"> |</a>|

            default = TEXT
            default.field = username
            default.noTrimWrap = |<a class="dropdown-toggle" data-toggle="dropdown" href="#" style="padding-top: 4px; padding-bottom: 4px;"> | <b class="caret"></b></a>|
        }

        20 = COA
        20 {
            stdWrap.wrap = <ul class="dropdown-menu"> | </ul>
            stdWrap.if.value = 0
            stdWrap.if.isGreaterThan.field = uid

            10 = TEXT
            10.data = LLL:EXT:t3forum/Resources/Private/Language/locallang.xml:Button_User_Profile
            10.typolink {
                parameter.field = profilePageUid
                additionalParams.field = uid
                additionalParams.wrap = &tx_t3forum_pi1[controller]=User&tx_t3forum_pi1[action]=show&tx_t3forum_pi1[user]=|
                ATagBeforeWrap = 1
                wrap = <i class="tx-t3forum-icon-16-user-profile"></i>
            }

            10.wrap = <li>|</li>

            50 = TEXT
            50.if.value.field = contact_twitter
            50.if.isTrue = 1
            50.value = Twitter
            50.wrap = <li>|</li>
            50.typolink {
                extTarget = _blank
                parameter.field = contact_twitter
                parameter.wrap = http://twitter.com/#!/|
                ATagBeforeWrap = 1
                wrap = <i class="tx-t3forum-icon-16-user-twitter"></i>
            }
        }
    }
}

plugin.tx_t3forum.renderer.icons {
    abstract_icon = COA
    abstract_icon {
        10 = IMG_RESOURCE
        10.file = EXT:t3forum/Resources/Public/Images/Icons/Forum/BaseIcon.png
        10.stdWrap.wrap = <div class="tx-t3forum-icon" style="background: url(|) no-repeat">

        100 = TEXT
        100.value = </div>
    }

    report < .abstract_icon
    report {
        10.file = EXT:t3forum/Resources/Public/Images/Icons/Moderation/Report-32.png

        21 = IMG_RESOURCE
        21.file.import.field = statusIcon
        21.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-br" style="background-image: url(|)"></div>
    }

    forum < .abstract_icon
    forum {
        10.file = EXT:t3forum/Resources/Public/Images/Icons/Forum/BaseIcon.png
        21 = IMG_RESOURCE
        21.file = EXT:t3forum/Resources/Public/Images/Icons/Forum/OverlayLocked.png
        21.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-bl" style="background-image: url(|)" title="closed"></div>
        21.stdWrap.if.isTrue.field = closed
    }

    forum_new < .forum
    forum_new {
        10.file = EXT:t3forum/Resources/Public/Images/Icons/Forum/BaseIcon.png

        21 = IMG_RESOURCE
        21.file = EXT:t3forum/Resources/Public/Images/Icons/Forum/OverlayLocked.png
        21.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-bl" style="background-image: url(|)" title="closed &amp; new"></div>
        21.stdWrap.if.isTrue.field = closed

        26 = IMG_RESOURCE
        26.file = EXT:t3forum/Resources/Public/Images/Icons/Forum/OverlayNew.png
        26.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-bl" style="background-image: url(|)" title="new"></div>
        26.stdWrap.if.isFalse.field = closed
    }

    topic < .abstract_icon
    topic {
        10.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/BaseIcon.png

        20 = IMG_RESOURCE
        20.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/OverlayImportant.png
        20.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-tl" style="background-image: url(|)" title="important"></div>
        20.stdWrap.if.isTrue.field = important

        22 = IMG_RESOURCE
        22.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/OverlayLocked.png
        22.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-bl" style="background-image: url(|)" title="closed"></div>
        22.stdWrap.if.isTrue.field = closed

        23 = IMG_RESOURCE
        23.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/OverlaySolved.png
        23.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-br" style="background-image: url(|)" title="solved"></div>
        23.stdWrap.if.isTrue.field = solved

        24 = IMG_RESOURCE
        24.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/OverlayMoved.png
        24.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-br" style="background-image: url(|)" title="moved"></div>
        24.stdWrap.if.isTrue.field = moved

        25 = IMG_RESOURCE
        25.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/OverlaySticky.png
        25.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-tr" style="background-image: url(|)" title="sticky"></div>
        25.stdWrap.if.isTrue.field = sticky
    }

    topic_new < .topic
    topic_new {
        10.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/BaseIcon.png

        22 = IMG_RESOURCE
        22.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/OverlayLocked.png
        22.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-bl" style="background-image: url(|)" title="closed &amp; new"></div>
        22.stdWrap.if.isTrue.field = closed

        26 = IMG_RESOURCE
        26.file = EXT:t3forum/Resources/Public/Images/Icons/Topic/OverlayNew.png
        26.stdWrap.wrap = <div class="tx-t3forum-icon-overlay-bl" style="background-image: url(|)" title="new"></div>
        26.stdWrap.if.isFalse.field = closed
    }
}

plugin.tx_t3forum.userfields {
    text.output = TEXT
    text.output {
        current = 1
    }

    date.output = TEXT
    date.output {
        current = 1
        date = d. m. Y
    }

    country.output = CONTENT
    country.output {
        select {
            selectFields = cn_official_name_local
            andWhere.current = 1
            andWhere.wrap = cn_iso_3="|"
            pidInList = 0
        }

        table = static_countries
        renderObj = TEXT
        renderObj.field = cn_official_name_local
    }

    gender.output = CASE
    gender.output {
        0 = TEXT
        0.value = Male
        1 = TEXT
        1.value = Female
        99 = TEXT
        99.value = Hidden
        key.current = 1
    }
}

[globalVar = LIT:1 = {$plugin.tx_t3forum.settings.useDefaultCSS}]
page.includeCSS {
    t3forum = EXT:t3forum/Resources/Public/Stylesheets/t3forum.css
    bootstrap = EXT:t3forum/Resources/Public/Bootstrap/css/bootstrap.css
    markitup_bb = EXT:t3forum/Resources/Public/Javascript/markitup/sets/t3forum/style.css
}
[global]

page.includeJSLibs {
    t3forum_jquery = https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js
    t3forum_jquery.external = 1
    t3forum_bootstrap = https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js
    t3forum_bootstrap.external = 1
    t3forum_markitup = EXT:t3forum/Resources/Public/Javascript/markitup/jquery.markitup.js
}

page.includeJSFooter {
    t3forum_main = EXT:t3forum/Resources/Public/Javascript/forum.js
}

module.tx_t3forum.persistence {
    storagePid = {$plugin.tx_t3forum.persistence.storagePid}
}

plugin.tx_t3forum.persistence {
    storagePid = {$plugin.tx_t3forum.persistence.storagePid}
}

lib.pageUid = TEXT
lib.pageUid.data = page:uid
